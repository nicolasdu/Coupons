<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" type="text/css" href="./style.css">
<meta http-equiv="Content-Type" content="text/html" charset="UTF-8">
<title>Update Coupon</title>
<script>

	var xmlhttp;
	function init() {
		
		xmlhttp=new XMLHttpRequest ();
	}
	
	function getDetails (){
		alert("get");
		var coupon=document.getElementById("coupid");
		var url = "http://localhost:8080/Coupons/rest/companyService/getcoupon?couponId="+coupon.value;
		xmlhttp.open('GET', url, true);
		xmlhttp.send(null);
		alert("sent");
		xmlhttp.onreadystatechange=function(){
			var start=document.getElementById("start"); 
			var end=document.getElementById("end"); 
			var type=document.getElementById("type"); 
			var message=document.getElementById("message"); 
			var couptitle=document.getElementById("couptitle"); 
			var amount=document.getElementById("amount"); 
			var image=document.getElementById("image"); 
			var price=document.getElementById("price"); 
			
			if(xmlhttp.readyState == 4){
				if(xmlhttp.status == 200){
						
					var det= eval("(" + xmlhttp.responseText+")");	
					if(coupon.value > 0){
			
						start.value=det.start;
						end.value=det.end;
						type.value=det.type;
						message.value=det.message;
						couptitle.value=det.couptitle;
						amount.value=det.amount;
						image.value=det.image;
						price.value=det.price;
						
					}
					else{
						
						start.value="";
						end.value="";
						type.value="";
						message.value="";
						couptitle.value="";
						amount.value="";
						image.value="";
						price.value="";
						aler(" Invalid Coupon Id ");
					}
				}
				else { 
					
					alert("Error -->" +xmlhttp.responseText);
				}
			}
			
		}
	}
	
	function setDetails() {
		alert("set details 2");
		var coupid=document.getElementById("coupid");
		var couptitle=document.getElementById("couptitle"); 
		var start=document.getElementById("start");
		var end=document.getElementById("end");
		var type=document.getElementById("type");
		var message=document.getElementById("message"); 
		var amount=document.getElementById("amount");
		var price=document.getElementById("price");
		var image=document.getElementById("image");
		alert(image.src);
		
		var url ="http://localhost:8080/Coupons/rest/companyService/updatecoupon?id="+coupid.value+"&title="+couptitle.value+"&start="+start.value+"&end="+end.value+"&type="+type.value+"&message="+message.value+"&amount="+amount.value+"&price="+price.value+"&image="+image.src;
		xmlhttp.open('PUT',url, true);
		xmlhttp.send(null);
		alert("SENT");
	}
</script>
</head>

<body onload="init()">

	<h1>Update The Coupon's Info</h1>
	 <table id="table">
	 	<tr>
	 		<th>Enter Coupon's Id</th>
	 		<td><input type="text" id="coupid" size="10" /> <input id="button" type="button" value="Get Info" onClick="getDetails()"/></td>
	 	</tr>	
	 	
	 	<tr>
	 		<th>Enter Coupon's Start Date</th>
	 		<td><input type="date" id="start" placeholder="YYYY-MM-DD" size="30"/></td>
	 	</tr>
	 	
	 	<tr>
	 		<th>Enter Coupon's End Date</th>
	 		<td><input type="date" id="end" placeholder="YYYY-MM-DD" size="30"/></td>
	 	</tr>
	 	
	 	<tr>
	 		<th>Choose Type</th>
	 		<td>
			 <select id="type">
				  <option value="RESTURANTS">RESTURANTS</option>
				  <option value="ELECTRICITY">ELECTRICITY</option>
				  <option value="FOOD">FOOD</option>
				  <option value="HEALTH">HEALTH</option>
				  <option value="SPORT">SPORT</option>
				  <option value="CAMPING">CAMPING</option>
				  <option value="TRAVELLING">TRAVELLING</option>
			</select>
			</td>
	 	</tr>
	 	
	 	<tr>
	 		<th>Enter A Message</th>
	 		<td><textarea id="message" size="30"></textarea></td>
	 	</tr>
	 	
	 	<tr>
	 		<th>Enter Coupon's  Title</th>
	 		<td><input type="text" id="couptitle" size="30"/></td>
	 	</tr>
	 	
	 	<tr>
	 		<th>Enter Amount</th>
	 		<td><input type="text" id="amount" size="30"/></td>
	 	</tr>
	 	
	 	<tr>
	 		<th>Attach an Image</th>
	 		<td><input type="file" id="image" name="profile_photo" placeholder="Photo" required="" capture></td>
	 	</tr>
	 	
	 	<tr>
	 		<th>Enter Price</th>
	 		<td><input type="text" id="price" size="30"/>&nbsp<input id="button" type="button" value="Update Coupon" onClick="setDetails()"/></td>
	 	</tr>
	 	
	 </table>

</body>
</html>